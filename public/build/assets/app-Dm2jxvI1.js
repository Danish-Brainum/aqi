function ot(e,t){return function(){return e.apply(t,arguments)}}const{toString:qt}=Object.prototype,{getPrototypeOf:$e}=Object,{iterator:Le,toStringTag:it}=Symbol,Re=(e=>t=>{const n=qt.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),W=e=>(e=e.toLowerCase(),t=>Re(t)===e),Te=e=>t=>typeof t===e,{isArray:ae}=Array,ie=Te("undefined");function de(e){return e!==null&&!ie(e)&&e.constructor!==null&&!ie(e.constructor)&&D(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const at=W("ArrayBuffer");function Nt(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&at(e.buffer),t}const It=Te("string"),D=Te("function"),ct=Te("number"),ue=e=>e!==null&&typeof e=="object",Ft=e=>e===!0||e===!1,we=e=>{if(Re(e)!=="object")return!1;const t=$e(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(it in e)&&!(Le in e)},Pt=e=>{if(!ue(e)||de(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},$t=W("Date"),Dt=W("File"),jt=W("Blob"),Ut=W("FileList"),Ht=e=>ue(e)&&D(e.pipe),_t=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||D(e.append)&&((t=Re(e))==="formdata"||t==="object"&&D(e.toString)&&e.toString()==="[object FormData]"))},zt=W("URLSearchParams"),[Vt,Wt,Jt,Xt]=["ReadableStream","Request","Response","Headers"].map(W),Kt=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function fe(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let s,r;if(typeof e!="object"&&(e=[e]),ae(e))for(s=0,r=e.length;s<r;s++)t.call(null,e[s],s,e);else{if(de(e))return;const i=n?Object.getOwnPropertyNames(e):Object.keys(e),o=i.length;let a;for(s=0;s<o;s++)a=i[s],t.call(null,e[a],a,e)}}function lt(e,t){if(de(e))return null;t=t.toLowerCase();const n=Object.keys(e);let s=n.length,r;for(;s-- >0;)if(r=n[s],t===r.toLowerCase())return r;return null}const ee=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,dt=e=>!ie(e)&&e!==ee;function qe(){const{caseless:e,skipUndefined:t}=dt(this)&&this||{},n={},s=(r,i)=>{const o=e&&lt(n,i)||i;we(n[o])&&we(r)?n[o]=qe(n[o],r):we(r)?n[o]=qe({},r):ae(r)?n[o]=r.slice():(!t||!ie(r))&&(n[o]=r)};for(let r=0,i=arguments.length;r<i;r++)arguments[r]&&fe(arguments[r],s);return n}const Gt=(e,t,n,{allOwnKeys:s}={})=>(fe(t,(r,i)=>{n&&D(r)?e[i]=ot(r,n):e[i]=r},{allOwnKeys:s}),e),Qt=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Zt=(e,t,n,s)=>{e.prototype=Object.create(t.prototype,s),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},Yt=(e,t,n,s)=>{let r,i,o;const a={};if(t=t||{},e==null)return t;do{for(r=Object.getOwnPropertyNames(e),i=r.length;i-- >0;)o=r[i],(!s||s(o,e,t))&&!a[o]&&(t[o]=e[o],a[o]=!0);e=n!==!1&&$e(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},en=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const s=e.indexOf(t,n);return s!==-1&&s===n},tn=e=>{if(!e)return null;if(ae(e))return e;let t=e.length;if(!ct(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},nn=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&$e(Uint8Array)),sn=(e,t)=>{const s=(e&&e[Le]).call(e);let r;for(;(r=s.next())&&!r.done;){const i=r.value;t.call(e,i[0],i[1])}},rn=(e,t)=>{let n;const s=[];for(;(n=e.exec(t))!==null;)s.push(n);return s},on=W("HTMLFormElement"),an=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,s,r){return s.toUpperCase()+r}),_e=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),cn=W("RegExp"),ut=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),s={};fe(n,(r,i)=>{let o;(o=t(r,i,e))!==!1&&(s[i]=o||r)}),Object.defineProperties(e,s)},ln=e=>{ut(e,(t,n)=>{if(D(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const s=e[n];if(D(s)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},dn=(e,t)=>{const n={},s=r=>{r.forEach(i=>{n[i]=!0})};return ae(e)?s(e):s(String(e).split(t)),n},un=()=>{},fn=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function pn(e){return!!(e&&D(e.append)&&e[it]==="FormData"&&e[Le])}const mn=e=>{const t=new Array(10),n=(s,r)=>{if(ue(s)){if(t.indexOf(s)>=0)return;if(de(s))return s;if(!("toJSON"in s)){t[r]=s;const i=ae(s)?[]:{};return fe(s,(o,a)=>{const f=n(o,r+1);!ie(f)&&(i[a]=f)}),t[r]=void 0,i}}return s};return n(e,0)},hn=W("AsyncFunction"),gn=e=>e&&(ue(e)||D(e))&&D(e.then)&&D(e.catch),ft=((e,t)=>e?setImmediate:t?((n,s)=>(ee.addEventListener("message",({source:r,data:i})=>{r===ee&&i===n&&s.length&&s.shift()()},!1),r=>{s.push(r),ee.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",D(ee.postMessage)),yn=typeof queueMicrotask<"u"?queueMicrotask.bind(ee):typeof process<"u"&&process.nextTick||ft,bn=e=>e!=null&&D(e[Le]),c={isArray:ae,isArrayBuffer:at,isBuffer:de,isFormData:_t,isArrayBufferView:Nt,isString:It,isNumber:ct,isBoolean:Ft,isObject:ue,isPlainObject:we,isEmptyObject:Pt,isReadableStream:Vt,isRequest:Wt,isResponse:Jt,isHeaders:Xt,isUndefined:ie,isDate:$t,isFile:Dt,isBlob:jt,isRegExp:cn,isFunction:D,isStream:Ht,isURLSearchParams:zt,isTypedArray:nn,isFileList:Ut,forEach:fe,merge:qe,extend:Gt,trim:Kt,stripBOM:Qt,inherits:Zt,toFlatObject:Yt,kindOf:Re,kindOfTest:W,endsWith:en,toArray:tn,forEachEntry:sn,matchAll:rn,isHTMLForm:on,hasOwnProperty:_e,hasOwnProp:_e,reduceDescriptors:ut,freezeMethods:ln,toObjectSet:dn,toCamelCase:an,noop:un,toFiniteNumber:fn,findKey:lt,global:ee,isContextDefined:dt,isSpecCompliantForm:pn,toJSONObject:mn,isAsyncFn:hn,isThenable:gn,setImmediate:ft,asap:yn,isIterable:bn};function S(e,t,n,s,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),s&&(this.request=s),r&&(this.response=r,this.status=r.status?r.status:null)}c.inherits(S,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:c.toJSONObject(this.config),code:this.code,status:this.status}}});const pt=S.prototype,mt={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{mt[e]={value:e}});Object.defineProperties(S,mt);Object.defineProperty(pt,"isAxiosError",{value:!0});S.from=(e,t,n,s,r,i)=>{const o=Object.create(pt);c.toFlatObject(e,o,function(u){return u!==Error.prototype},d=>d!=="isAxiosError");const a=e&&e.message?e.message:"Error",f=t==null&&e?e.code:t;return S.call(o,a,f,n,s,r),e&&o.cause==null&&Object.defineProperty(o,"cause",{value:e,configurable:!0}),o.name=e&&e.name||"Error",i&&Object.assign(o,i),o};const En=null;function Ne(e){return c.isPlainObject(e)||c.isArray(e)}function ht(e){return c.endsWith(e,"[]")?e.slice(0,-2):e}function ze(e,t,n){return e?e.concat(t).map(function(r,i){return r=ht(r),!n&&i?"["+r+"]":r}).join(n?".":""):t}function wn(e){return c.isArray(e)&&!e.some(Ne)}const xn=c.toFlatObject(c,{},null,function(t){return/^is[A-Z]/.test(t)});function Ce(e,t,n){if(!c.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=c.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(y,g){return!c.isUndefined(g[y])});const s=n.metaTokens,r=n.visitor||u,i=n.dots,o=n.indexes,f=(n.Blob||typeof Blob<"u"&&Blob)&&c.isSpecCompliantForm(t);if(!c.isFunction(r))throw new TypeError("visitor must be a function");function d(l){if(l===null)return"";if(c.isDate(l))return l.toISOString();if(c.isBoolean(l))return l.toString();if(!f&&c.isBlob(l))throw new S("Blob is not supported. Use a Buffer instead.");return c.isArrayBuffer(l)||c.isTypedArray(l)?f&&typeof Blob=="function"?new Blob([l]):Buffer.from(l):l}function u(l,y,g){let L=l;if(l&&!g&&typeof l=="object"){if(c.endsWith(y,"{}"))y=s?y:y.slice(0,-2),l=JSON.stringify(l);else if(c.isArray(l)&&wn(l)||(c.isFileList(l)||c.endsWith(y,"[]"))&&(L=c.toArray(l)))return y=ht(y),L.forEach(function(E,x){!(c.isUndefined(E)||E===null)&&t.append(o===!0?ze([y],x,i):o===null?y:y+"[]",d(E))}),!1}return Ne(l)?!0:(t.append(ze(g,y,i),d(l)),!1)}const m=[],h=Object.assign(xn,{defaultVisitor:u,convertValue:d,isVisitable:Ne});function b(l,y){if(!c.isUndefined(l)){if(m.indexOf(l)!==-1)throw Error("Circular reference detected in "+y.join("."));m.push(l),c.forEach(l,function(L,A){(!(c.isUndefined(L)||L===null)&&r.call(t,L,c.isString(A)?A.trim():A,y,h))===!0&&b(L,y?y.concat(A):[A])}),m.pop()}}if(!c.isObject(e))throw new TypeError("data must be an object");return b(e),t}function Ve(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(s){return t[s]})}function De(e,t){this._pairs=[],e&&Ce(e,this,t)}const gt=De.prototype;gt.append=function(t,n){this._pairs.push([t,n])};gt.toString=function(t){const n=t?function(s){return t.call(this,s,Ve)}:Ve;return this._pairs.map(function(r){return n(r[0])+"="+n(r[1])},"").join("&")};function Sn(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function yt(e,t,n){if(!t)return e;const s=n&&n.encode||Sn;c.isFunction(n)&&(n={serialize:n});const r=n&&n.serialize;let i;if(r?i=r(t,n):i=c.isURLSearchParams(t)?t.toString():new De(t,n).toString(s),i){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class We{constructor(){this.handlers=[]}use(t,n,s){return this.handlers.push({fulfilled:t,rejected:n,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){c.forEach(this.handlers,function(s){s!==null&&t(s)})}}const bt={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},vn=typeof URLSearchParams<"u"?URLSearchParams:De,Ln=typeof FormData<"u"?FormData:null,Rn=typeof Blob<"u"?Blob:null,Tn={isBrowser:!0,classes:{URLSearchParams:vn,FormData:Ln,Blob:Rn},protocols:["http","https","file","blob","url","data"]},je=typeof window<"u"&&typeof document<"u",Ie=typeof navigator=="object"&&navigator||void 0,Cn=je&&(!Ie||["ReactNative","NativeScript","NS"].indexOf(Ie.product)<0),An=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",On=je&&window.location.href||"http://localhost",Bn=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:je,hasStandardBrowserEnv:Cn,hasStandardBrowserWebWorkerEnv:An,navigator:Ie,origin:On},Symbol.toStringTag,{value:"Module"})),P={...Bn,...Tn};function kn(e,t){return Ce(e,new P.classes.URLSearchParams,{visitor:function(n,s,r,i){return P.isNode&&c.isBuffer(n)?(this.append(s,n.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}function Mn(e){return c.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function qn(e){const t={},n=Object.keys(e);let s;const r=n.length;let i;for(s=0;s<r;s++)i=n[s],t[i]=e[i];return t}function Et(e){function t(n,s,r,i){let o=n[i++];if(o==="__proto__")return!0;const a=Number.isFinite(+o),f=i>=n.length;return o=!o&&c.isArray(r)?r.length:o,f?(c.hasOwnProp(r,o)?r[o]=[r[o],s]:r[o]=s,!a):((!r[o]||!c.isObject(r[o]))&&(r[o]=[]),t(n,s,r[o],i)&&c.isArray(r[o])&&(r[o]=qn(r[o])),!a)}if(c.isFormData(e)&&c.isFunction(e.entries)){const n={};return c.forEachEntry(e,(s,r)=>{t(Mn(s),r,n,0)}),n}return null}function Nn(e,t,n){if(c.isString(e))try{return(t||JSON.parse)(e),c.trim(e)}catch(s){if(s.name!=="SyntaxError")throw s}return(n||JSON.stringify)(e)}const pe={transitional:bt,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const s=n.getContentType()||"",r=s.indexOf("application/json")>-1,i=c.isObject(t);if(i&&c.isHTMLForm(t)&&(t=new FormData(t)),c.isFormData(t))return r?JSON.stringify(Et(t)):t;if(c.isArrayBuffer(t)||c.isBuffer(t)||c.isStream(t)||c.isFile(t)||c.isBlob(t)||c.isReadableStream(t))return t;if(c.isArrayBufferView(t))return t.buffer;if(c.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let a;if(i){if(s.indexOf("application/x-www-form-urlencoded")>-1)return kn(t,this.formSerializer).toString();if((a=c.isFileList(t))||s.indexOf("multipart/form-data")>-1){const f=this.env&&this.env.FormData;return Ce(a?{"files[]":t}:t,f&&new f,this.formSerializer)}}return i||r?(n.setContentType("application/json",!1),Nn(t)):t}],transformResponse:[function(t){const n=this.transitional||pe.transitional,s=n&&n.forcedJSONParsing,r=this.responseType==="json";if(c.isResponse(t)||c.isReadableStream(t))return t;if(t&&c.isString(t)&&(s&&!this.responseType||r)){const o=!(n&&n.silentJSONParsing)&&r;try{return JSON.parse(t,this.parseReviver)}catch(a){if(o)throw a.name==="SyntaxError"?S.from(a,S.ERR_BAD_RESPONSE,this,null,this.response):a}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:P.classes.FormData,Blob:P.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};c.forEach(["delete","get","head","post","put","patch"],e=>{pe.headers[e]={}});const In=c.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Fn=e=>{const t={};let n,s,r;return e&&e.split(`
`).forEach(function(o){r=o.indexOf(":"),n=o.substring(0,r).trim().toLowerCase(),s=o.substring(r+1).trim(),!(!n||t[n]&&In[n])&&(n==="set-cookie"?t[n]?t[n].push(s):t[n]=[s]:t[n]=t[n]?t[n]+", "+s:s)}),t},Je=Symbol("internals");function le(e){return e&&String(e).trim().toLowerCase()}function xe(e){return e===!1||e==null?e:c.isArray(e)?e.map(xe):String(e)}function Pn(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=n.exec(e);)t[s[1]]=s[2];return t}const $n=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Be(e,t,n,s,r){if(c.isFunction(s))return s.call(this,t,n);if(r&&(t=n),!!c.isString(t)){if(c.isString(s))return t.indexOf(s)!==-1;if(c.isRegExp(s))return s.test(t)}}function Dn(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,s)=>n.toUpperCase()+s)}function jn(e,t){const n=c.toCamelCase(" "+t);["get","set","has"].forEach(s=>{Object.defineProperty(e,s+n,{value:function(r,i,o){return this[s].call(this,t,r,i,o)},configurable:!0})})}let j=class{constructor(t){t&&this.set(t)}set(t,n,s){const r=this;function i(a,f,d){const u=le(f);if(!u)throw new Error("header name must be a non-empty string");const m=c.findKey(r,u);(!m||r[m]===void 0||d===!0||d===void 0&&r[m]!==!1)&&(r[m||f]=xe(a))}const o=(a,f)=>c.forEach(a,(d,u)=>i(d,u,f));if(c.isPlainObject(t)||t instanceof this.constructor)o(t,n);else if(c.isString(t)&&(t=t.trim())&&!$n(t))o(Fn(t),n);else if(c.isObject(t)&&c.isIterable(t)){let a={},f,d;for(const u of t){if(!c.isArray(u))throw TypeError("Object iterator must return a key-value pair");a[d=u[0]]=(f=a[d])?c.isArray(f)?[...f,u[1]]:[f,u[1]]:u[1]}o(a,n)}else t!=null&&i(n,t,s);return this}get(t,n){if(t=le(t),t){const s=c.findKey(this,t);if(s){const r=this[s];if(!n)return r;if(n===!0)return Pn(r);if(c.isFunction(n))return n.call(this,r,s);if(c.isRegExp(n))return n.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=le(t),t){const s=c.findKey(this,t);return!!(s&&this[s]!==void 0&&(!n||Be(this,this[s],s,n)))}return!1}delete(t,n){const s=this;let r=!1;function i(o){if(o=le(o),o){const a=c.findKey(s,o);a&&(!n||Be(s,s[a],a,n))&&(delete s[a],r=!0)}}return c.isArray(t)?t.forEach(i):i(t),r}clear(t){const n=Object.keys(this);let s=n.length,r=!1;for(;s--;){const i=n[s];(!t||Be(this,this[i],i,t,!0))&&(delete this[i],r=!0)}return r}normalize(t){const n=this,s={};return c.forEach(this,(r,i)=>{const o=c.findKey(s,i);if(o){n[o]=xe(r),delete n[i];return}const a=t?Dn(i):String(i).trim();a!==i&&delete n[i],n[a]=xe(r),s[a]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return c.forEach(this,(s,r)=>{s!=null&&s!==!1&&(n[r]=t&&c.isArray(s)?s.join(", "):s)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const s=new this(t);return n.forEach(r=>s.set(r)),s}static accessor(t){const s=(this[Je]=this[Je]={accessors:{}}).accessors,r=this.prototype;function i(o){const a=le(o);s[a]||(jn(r,o),s[a]=!0)}return c.isArray(t)?t.forEach(i):i(t),this}};j.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);c.reduceDescriptors(j.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(s){this[n]=s}}});c.freezeMethods(j);function ke(e,t){const n=this||pe,s=t||n,r=j.from(s.headers);let i=s.data;return c.forEach(e,function(a){i=a.call(n,i,r.normalize(),t?t.status:void 0)}),r.normalize(),i}function wt(e){return!!(e&&e.__CANCEL__)}function ce(e,t,n){S.call(this,e??"canceled",S.ERR_CANCELED,t,n),this.name="CanceledError"}c.inherits(ce,S,{__CANCEL__:!0});function xt(e,t,n){const s=n.config.validateStatus;!n.status||!s||s(n.status)?e(n):t(new S("Request failed with status code "+n.status,[S.ERR_BAD_REQUEST,S.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function Un(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function Hn(e,t){e=e||10;const n=new Array(e),s=new Array(e);let r=0,i=0,o;return t=t!==void 0?t:1e3,function(f){const d=Date.now(),u=s[i];o||(o=d),n[r]=f,s[r]=d;let m=i,h=0;for(;m!==r;)h+=n[m++],m=m%e;if(r=(r+1)%e,r===i&&(i=(i+1)%e),d-o<t)return;const b=u&&d-u;return b?Math.round(h*1e3/b):void 0}}function _n(e,t){let n=0,s=1e3/t,r,i;const o=(d,u=Date.now())=>{n=u,r=null,i&&(clearTimeout(i),i=null),e(...d)};return[(...d)=>{const u=Date.now(),m=u-n;m>=s?o(d,u):(r=d,i||(i=setTimeout(()=>{i=null,o(r)},s-m)))},()=>r&&o(r)]}const ve=(e,t,n=3)=>{let s=0;const r=Hn(50,250);return _n(i=>{const o=i.loaded,a=i.lengthComputable?i.total:void 0,f=o-s,d=r(f),u=o<=a;s=o;const m={loaded:o,total:a,progress:a?o/a:void 0,bytes:f,rate:d||void 0,estimated:d&&a&&u?(a-o)/d:void 0,event:i,lengthComputable:a!=null,[t?"download":"upload"]:!0};e(m)},n)},Xe=(e,t)=>{const n=e!=null;return[s=>t[0]({lengthComputable:n,total:e,loaded:s}),t[1]]},Ke=e=>(...t)=>c.asap(()=>e(...t)),zn=P.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,P.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(P.origin),P.navigator&&/(msie|trident)/i.test(P.navigator.userAgent)):()=>!0,Vn=P.hasStandardBrowserEnv?{write(e,t,n,s,r,i){const o=[e+"="+encodeURIComponent(t)];c.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),c.isString(s)&&o.push("path="+s),c.isString(r)&&o.push("domain="+r),i===!0&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Wn(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function Jn(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function St(e,t,n){let s=!Wn(t);return e&&(s||n==!1)?Jn(e,t):t}const Ge=e=>e instanceof j?{...e}:e;function ne(e,t){t=t||{};const n={};function s(d,u,m,h){return c.isPlainObject(d)&&c.isPlainObject(u)?c.merge.call({caseless:h},d,u):c.isPlainObject(u)?c.merge({},u):c.isArray(u)?u.slice():u}function r(d,u,m,h){if(c.isUndefined(u)){if(!c.isUndefined(d))return s(void 0,d,m,h)}else return s(d,u,m,h)}function i(d,u){if(!c.isUndefined(u))return s(void 0,u)}function o(d,u){if(c.isUndefined(u)){if(!c.isUndefined(d))return s(void 0,d)}else return s(void 0,u)}function a(d,u,m){if(m in t)return s(d,u);if(m in e)return s(void 0,d)}const f={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(d,u,m)=>r(Ge(d),Ge(u),m,!0)};return c.forEach(Object.keys({...e,...t}),function(u){const m=f[u]||r,h=m(e[u],t[u],u);c.isUndefined(h)&&m!==a||(n[u]=h)}),n}const vt=e=>{const t=ne({},e);let{data:n,withXSRFToken:s,xsrfHeaderName:r,xsrfCookieName:i,headers:o,auth:a}=t;if(t.headers=o=j.from(o),t.url=yt(St(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),a&&o.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):""))),c.isFormData(n)){if(P.hasStandardBrowserEnv||P.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(c.isFunction(n.getHeaders)){const f=n.getHeaders(),d=["content-type","content-length"];Object.entries(f).forEach(([u,m])=>{d.includes(u.toLowerCase())&&o.set(u,m)})}}if(P.hasStandardBrowserEnv&&(s&&c.isFunction(s)&&(s=s(t)),s||s!==!1&&zn(t.url))){const f=r&&i&&Vn.read(i);f&&o.set(r,f)}return t},Xn=typeof XMLHttpRequest<"u",Kn=Xn&&function(e){return new Promise(function(n,s){const r=vt(e);let i=r.data;const o=j.from(r.headers).normalize();let{responseType:a,onUploadProgress:f,onDownloadProgress:d}=r,u,m,h,b,l;function y(){b&&b(),l&&l(),r.cancelToken&&r.cancelToken.unsubscribe(u),r.signal&&r.signal.removeEventListener("abort",u)}let g=new XMLHttpRequest;g.open(r.method.toUpperCase(),r.url,!0),g.timeout=r.timeout;function L(){if(!g)return;const E=j.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders()),O={data:!a||a==="text"||a==="json"?g.responseText:g.response,status:g.status,statusText:g.statusText,headers:E,config:e,request:g};xt(function(R){n(R),y()},function(R){s(R),y()},O),g=null}"onloadend"in g?g.onloadend=L:g.onreadystatechange=function(){!g||g.readyState!==4||g.status===0&&!(g.responseURL&&g.responseURL.indexOf("file:")===0)||setTimeout(L)},g.onabort=function(){g&&(s(new S("Request aborted",S.ECONNABORTED,e,g)),g=null)},g.onerror=function(x){const O=x&&x.message?x.message:"Network Error",T=new S(O,S.ERR_NETWORK,e,g);T.event=x||null,s(T),g=null},g.ontimeout=function(){let x=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const O=r.transitional||bt;r.timeoutErrorMessage&&(x=r.timeoutErrorMessage),s(new S(x,O.clarifyTimeoutError?S.ETIMEDOUT:S.ECONNABORTED,e,g)),g=null},i===void 0&&o.setContentType(null),"setRequestHeader"in g&&c.forEach(o.toJSON(),function(x,O){g.setRequestHeader(O,x)}),c.isUndefined(r.withCredentials)||(g.withCredentials=!!r.withCredentials),a&&a!=="json"&&(g.responseType=r.responseType),d&&([h,l]=ve(d,!0),g.addEventListener("progress",h)),f&&g.upload&&([m,b]=ve(f),g.upload.addEventListener("progress",m),g.upload.addEventListener("loadend",b)),(r.cancelToken||r.signal)&&(u=E=>{g&&(s(!E||E.type?new ce(null,e,g):E),g.abort(),g=null)},r.cancelToken&&r.cancelToken.subscribe(u),r.signal&&(r.signal.aborted?u():r.signal.addEventListener("abort",u)));const A=Un(r.url);if(A&&P.protocols.indexOf(A)===-1){s(new S("Unsupported protocol "+A+":",S.ERR_BAD_REQUEST,e));return}g.send(i||null)})},Gn=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let s=new AbortController,r;const i=function(d){if(!r){r=!0,a();const u=d instanceof Error?d:this.reason;s.abort(u instanceof S?u:new ce(u instanceof Error?u.message:u))}};let o=t&&setTimeout(()=>{o=null,i(new S(`timeout ${t} of ms exceeded`,S.ETIMEDOUT))},t);const a=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(d=>{d.unsubscribe?d.unsubscribe(i):d.removeEventListener("abort",i)}),e=null)};e.forEach(d=>d.addEventListener("abort",i));const{signal:f}=s;return f.unsubscribe=()=>c.asap(a),f}},Qn=function*(e,t){let n=e.byteLength;if(n<t){yield e;return}let s=0,r;for(;s<n;)r=s+t,yield e.slice(s,r),s=r},Zn=async function*(e,t){for await(const n of Yn(e))yield*Qn(n,t)},Yn=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:n,value:s}=await t.read();if(n)break;yield s}}finally{await t.cancel()}},Qe=(e,t,n,s)=>{const r=Zn(e,t);let i=0,o,a=f=>{o||(o=!0,s&&s(f))};return new ReadableStream({async pull(f){try{const{done:d,value:u}=await r.next();if(d){a(),f.close();return}let m=u.byteLength;if(n){let h=i+=m;n(h)}f.enqueue(new Uint8Array(u))}catch(d){throw a(d),d}},cancel(f){return a(f),r.return()}},{highWaterMark:2})},Ze=64*1024,{isFunction:Ee}=c,Lt=(({fetch:e,Request:t,Response:n})=>({fetch:e,Request:t,Response:n}))(c.global),{ReadableStream:Ye,TextEncoder:et}=c.global,tt=(e,...t)=>{try{return!!e(...t)}catch{return!1}},es=e=>{const{fetch:t,Request:n,Response:s}=Object.assign({},Lt,e),r=Ee(t),i=Ee(n),o=Ee(s);if(!r)return!1;const a=r&&Ee(Ye),f=r&&(typeof et=="function"?(l=>y=>l.encode(y))(new et):async l=>new Uint8Array(await new n(l).arrayBuffer())),d=i&&a&&tt(()=>{let l=!1;const y=new n(P.origin,{body:new Ye,method:"POST",get duplex(){return l=!0,"half"}}).headers.has("Content-Type");return l&&!y}),u=o&&a&&tt(()=>c.isReadableStream(new s("").body)),m={stream:u&&(l=>l.body)};r&&["text","arrayBuffer","blob","formData","stream"].forEach(l=>{!m[l]&&(m[l]=(y,g)=>{let L=y&&y[l];if(L)return L.call(y);throw new S(`Response type '${l}' is not supported`,S.ERR_NOT_SUPPORT,g)})});const h=async l=>{if(l==null)return 0;if(c.isBlob(l))return l.size;if(c.isSpecCompliantForm(l))return(await new n(P.origin,{method:"POST",body:l}).arrayBuffer()).byteLength;if(c.isArrayBufferView(l)||c.isArrayBuffer(l))return l.byteLength;if(c.isURLSearchParams(l)&&(l=l+""),c.isString(l))return(await f(l)).byteLength},b=async(l,y)=>{const g=c.toFiniteNumber(l.getContentLength());return g??h(y)};return async l=>{let{url:y,method:g,data:L,signal:A,cancelToken:E,timeout:x,onDownloadProgress:O,onUploadProgress:T,responseType:R,headers:I,withCredentials:U="same-origin",fetchOptions:k}=vt(l);R=R?(R+"").toLowerCase():"text";let $=Gn([A,E&&E.toAbortSignal()],x),_=null;const F=$&&$.unsubscribe&&(()=>{$.unsubscribe()});let G;try{if(T&&d&&g!=="get"&&g!=="head"&&(G=await b(I,L))!==0){let V=new n(y,{method:"POST",body:L,duplex:"half"}),Z;if(c.isFormData(L)&&(Z=V.headers.get("content-type"))&&I.setContentType(Z),V.body){const[Y,K]=Xe(G,ve(Ke(T)));L=Qe(V.body,Ze,Y,K)}}c.isString(U)||(U=U?"include":"omit");const q=i&&"credentials"in n.prototype,Q={...k,signal:$,method:g.toUpperCase(),headers:I.normalize().toJSON(),body:L,duplex:"half",credentials:q?U:void 0};_=i&&new n(y,Q);let z=await(i?t(_,k):t(y,Q));const me=u&&(R==="stream"||R==="response");if(u&&(O||me&&F)){const V={};["status","statusText","headers"].forEach(ge=>{V[ge]=z[ge]});const Z=c.toFiniteNumber(z.headers.get("content-length")),[Y,K]=O&&Xe(Z,ve(Ke(O),!0))||[];z=new s(Qe(z.body,Ze,Y,()=>{K&&K(),F&&F()}),V)}R=R||"text";let he=await m[c.findKey(m,R)||"text"](z,l);return!me&&F&&F(),await new Promise((V,Z)=>{xt(V,Z,{data:he,headers:j.from(z.headers),status:z.status,statusText:z.statusText,config:l,request:_})})}catch(q){throw F&&F(),q&&q.name==="TypeError"&&/Load failed|fetch/i.test(q.message)?Object.assign(new S("Network Error",S.ERR_NETWORK,l,_),{cause:q.cause||q}):S.from(q,q&&q.code,l,_)}}},ts=new Map,Rt=e=>{let t=c.merge.call({skipUndefined:!0},Lt,e?e.env:null);const{fetch:n,Request:s,Response:r}=t,i=[s,r,n];let o=i.length,a=o,f,d,u=ts;for(;a--;)f=i[a],d=u.get(f),d===void 0&&u.set(f,d=a?new Map:es(t)),u=d;return d};Rt();const Fe={http:En,xhr:Kn,fetch:{get:Rt}};c.forEach(Fe,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const nt=e=>`- ${e}`,ns=e=>c.isFunction(e)||e===null||e===!1,Tt={getAdapter:(e,t)=>{e=c.isArray(e)?e:[e];const{length:n}=e;let s,r;const i={};for(let o=0;o<n;o++){s=e[o];let a;if(r=s,!ns(s)&&(r=Fe[(a=String(s)).toLowerCase()],r===void 0))throw new S(`Unknown adapter '${a}'`);if(r&&(c.isFunction(r)||(r=r.get(t))))break;i[a||"#"+o]=r}if(!r){const o=Object.entries(i).map(([f,d])=>`adapter ${f} `+(d===!1?"is not supported by the environment":"is not available in the build"));let a=n?o.length>1?`since :
`+o.map(nt).join(`
`):" "+nt(o[0]):"as no adapter specified";throw new S("There is no suitable adapter to dispatch the request "+a,"ERR_NOT_SUPPORT")}return r},adapters:Fe};function Me(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new ce(null,e)}function st(e){return Me(e),e.headers=j.from(e.headers),e.data=ke.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Tt.getAdapter(e.adapter||pe.adapter,e)(e).then(function(s){return Me(e),s.data=ke.call(e,e.transformResponse,s),s.headers=j.from(s.headers),s},function(s){return wt(s)||(Me(e),s&&s.response&&(s.response.data=ke.call(e,e.transformResponse,s.response),s.response.headers=j.from(s.response.headers))),Promise.reject(s)})}const Ct="1.12.0",Ae={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Ae[e]=function(s){return typeof s===e||"a"+(t<1?"n ":" ")+e}});const rt={};Ae.transitional=function(t,n,s){function r(i,o){return"[Axios v"+Ct+"] Transitional option '"+i+"'"+o+(s?". "+s:"")}return(i,o,a)=>{if(t===!1)throw new S(r(o," has been removed"+(n?" in "+n:"")),S.ERR_DEPRECATED);return n&&!rt[o]&&(rt[o]=!0,console.warn(r(o," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(i,o,a):!0}};Ae.spelling=function(t){return(n,s)=>(console.warn(`${s} is likely a misspelling of ${t}`),!0)};function ss(e,t,n){if(typeof e!="object")throw new S("options must be an object",S.ERR_BAD_OPTION_VALUE);const s=Object.keys(e);let r=s.length;for(;r-- >0;){const i=s[r],o=t[i];if(o){const a=e[i],f=a===void 0||o(a,i,e);if(f!==!0)throw new S("option "+i+" must be "+f,S.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new S("Unknown option "+i,S.ERR_BAD_OPTION)}}const Se={assertOptions:ss,validators:Ae},X=Se.validators;let te=class{constructor(t){this.defaults=t||{},this.interceptors={request:new We,response:new We}}async request(t,n){try{return await this._request(t,n)}catch(s){if(s instanceof Error){let r={};Error.captureStackTrace?Error.captureStackTrace(r):r=new Error;const i=r.stack?r.stack.replace(/^.+\n/,""):"";try{s.stack?i&&!String(s.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+i):s.stack=i}catch{}}throw s}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=ne(this.defaults,n);const{transitional:s,paramsSerializer:r,headers:i}=n;s!==void 0&&Se.assertOptions(s,{silentJSONParsing:X.transitional(X.boolean),forcedJSONParsing:X.transitional(X.boolean),clarifyTimeoutError:X.transitional(X.boolean)},!1),r!=null&&(c.isFunction(r)?n.paramsSerializer={serialize:r}:Se.assertOptions(r,{encode:X.function,serialize:X.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),Se.assertOptions(n,{baseUrl:X.spelling("baseURL"),withXsrfToken:X.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let o=i&&c.merge(i.common,i[n.method]);i&&c.forEach(["delete","get","head","post","put","patch","common"],l=>{delete i[l]}),n.headers=j.concat(o,i);const a=[];let f=!0;this.interceptors.request.forEach(function(y){typeof y.runWhen=="function"&&y.runWhen(n)===!1||(f=f&&y.synchronous,a.unshift(y.fulfilled,y.rejected))});const d=[];this.interceptors.response.forEach(function(y){d.push(y.fulfilled,y.rejected)});let u,m=0,h;if(!f){const l=[st.bind(this),void 0];for(l.unshift(...a),l.push(...d),h=l.length,u=Promise.resolve(n);m<h;)u=u.then(l[m++],l[m++]);return u}h=a.length;let b=n;for(m=0;m<h;){const l=a[m++],y=a[m++];try{b=l(b)}catch(g){y.call(this,g);break}}try{u=st.call(this,b)}catch(l){return Promise.reject(l)}for(m=0,h=d.length;m<h;)u=u.then(d[m++],d[m++]);return u}getUri(t){t=ne(this.defaults,t);const n=St(t.baseURL,t.url,t.allowAbsoluteUrls);return yt(n,t.params,t.paramsSerializer)}};c.forEach(["delete","get","head","options"],function(t){te.prototype[t]=function(n,s){return this.request(ne(s||{},{method:t,url:n,data:(s||{}).data}))}});c.forEach(["post","put","patch"],function(t){function n(s){return function(i,o,a){return this.request(ne(a||{},{method:t,headers:s?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}te.prototype[t]=n(),te.prototype[t+"Form"]=n(!0)});let rs=class At{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(i){n=i});const s=this;this.promise.then(r=>{if(!s._listeners)return;let i=s._listeners.length;for(;i-- >0;)s._listeners[i](r);s._listeners=null}),this.promise.then=r=>{let i;const o=new Promise(a=>{s.subscribe(a),i=a}).then(r);return o.cancel=function(){s.unsubscribe(i)},o},t(function(i,o,a){s.reason||(s.reason=new ce(i,o,a),n(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=s=>{t.abort(s)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new At(function(r){t=r}),cancel:t}}};function os(e){return function(n){return e.apply(null,n)}}function is(e){return c.isObject(e)&&e.isAxiosError===!0}const Pe={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Pe).forEach(([e,t])=>{Pe[t]=e});function Ot(e){const t=new te(e),n=ot(te.prototype.request,t);return c.extend(n,te.prototype,t,{allOwnKeys:!0}),c.extend(n,t,null,{allOwnKeys:!0}),n.create=function(r){return Ot(ne(e,r))},n}const M=Ot(pe);M.Axios=te;M.CanceledError=ce;M.CancelToken=rs;M.isCancel=wt;M.VERSION=Ct;M.toFormData=Ce;M.AxiosError=S;M.Cancel=M.CanceledError;M.all=function(t){return Promise.all(t)};M.spread=os;M.isAxiosError=is;M.mergeConfig=ne;M.AxiosHeaders=j;M.formToJSON=e=>Et(c.isHTMLForm(e)?new FormData(e):e);M.getAdapter=Tt.getAdapter;M.HttpStatusCode=Pe;M.default=M;const{Axios:Cs,AxiosError:As,CanceledError:Os,isCancel:Bs,CancelToken:ks,VERSION:Ms,all:qs,Cancel:Ns,isAxiosError:Is,spread:Fs,toFormData:Ps,AxiosHeaders:$s,HttpStatusCode:Ds,formToJSON:js,getAdapter:Us,mergeConfig:Hs}=M;window.axios=M;window.axios.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";function as(){function e(n){document.querySelectorAll(".tab-content").forEach(a=>a.classList.add("hidden"));const r=document.getElementById(n);r&&r.classList.remove("hidden"),document.querySelectorAll(".tab-btn").forEach(a=>a.removeAttribute("data-active"));const o=document.querySelector(`.tab-btn[data-tab="${n}"]`);o&&o.setAttribute("data-active","true")}const t=document.querySelectorAll(".tab-btn");t.length&&(t.forEach(n=>{n.addEventListener("click",()=>{const s=n.getAttribute("data-tab");s&&e(s)})}),e("upload"))}function cs(){const e=document.getElementById("dropzone"),t=document.getElementById("file-input"),n=document.getElementById("file-name"),s=document.getElementById("file-error"),r=document.getElementById("upload-form"),i=r?r.querySelector('button[type="submit"]'):null;if(!e||!t)return;function o(m){e.classList.toggle("ring-2",m),e.classList.toggle("ring-indigo-300",m)}["dragenter","dragover"].forEach(m=>e.addEventListener(m,h=>{h.preventDefault(),o(!0)})),["dragleave","drop"].forEach(m=>e.addEventListener(m,h=>{h.preventDefault(),o(!1)})),e.addEventListener("drop",m=>{const h=m.dataTransfer;h&&h.files.length&&(t.files=h.files,n&&(n.textContent=h.files[0].name),f(h.files[0]))}),t.addEventListener("change",()=>{t.files&&t.files.length&&n&&(n.textContent=t.files[0].name,f(t.files[0]))}),r&&r.addEventListener("submit",m=>{r.dataset.csvValid!=="true"&&m.preventDefault()});function a(m,h,b){if(s)if(m)s.textContent="",e.classList.remove("ring-2","ring-red-300"),i&&(i.disabled=!1,i.classList.remove("opacity-50","cursor-not-allowed")),r&&(r.dataset.csvValid="true",r.dataset.autoSubmitted!=="true"&&(r.dataset.autoSubmitted="true",r.submit()));else{const l=b?.length?` Found headers: ${b.join(", ")}`:"";s.textContent=`${h}${l}`,e.classList.add("ring-2","ring-red-300"),i&&(i.disabled=!0,i.classList.add("opacity-50","cursor-not-allowed")),r&&(r.dataset.csvValid="false",r.dataset.autoSubmitted="false")}}function f(m){if(!m)return;const h=new FileReader;h.onload=()=>{const b=h.result?.toString()||"",l=d(b);if(!l){a(!1,"CSV appears to be empty. Expected headers: Name, Email, City, Phone");return}const y=u(l),g=y.map(x=>x.replace(/^\ufeff/,"").trim().replace(/^"|"$/g,"").toLowerCase()),L=["name","email","city","phone"],A=g.filter(x=>!L.includes(x)),E=L.filter(x=>!g.includes(x));g.length!==4||A.length>0||E.length>0?a(!1,"CSV headers must be exactly: Name, Email, City, Phone.",y):a(!0)},h.onerror=()=>{a(!1,"Could not read the file. Please try again.")},h.readAsText(m.slice(0,65536))}function d(m){return m.split(/\r?\n/).find(h=>h.trim())||""}function u(m){const h=[];let b="",l=!1;for(let y=0;y<m.length;y++){const g=m[y];g=='"'?l&&m[y+1]=='"'?(b+='"',y++):l=!l:g==","&&!l?(h.push(b.trim()),b=""):b+=g}return h.push(b.trim()),h}}function ls(){const e=document.getElementById("profile-button"),t=document.getElementById("profile-dropdown");if(!e||!t)return;function n(s){s&&(e.contains(s.target)||t.contains(s.target))||(t.classList.add("hidden"),document.removeEventListener("click",n))}e.addEventListener("click",s=>{s.stopPropagation(),t.classList.toggle("hidden"),t.classList.contains("hidden")?document.removeEventListener("click",n):setTimeout(()=>document.addEventListener("click",n),0)})}function ds(){const e=document.getElementById("whatsapp-modal"),t=document.getElementById("whatsappModalContent"),n=document.getElementById("open-whatsapp-modal"),s=document.getElementById("closeWhatsappModal"),r=document.getElementById("closeWhatsappBtn");if(!e||!t)return;function i(){e.classList.remove("hidden"),requestAnimationFrame(()=>{t.classList.remove("opacity-0","scale-95"),t.classList.add("opacity-100","scale-100")})}function o(){t.classList.remove("opacity-100","scale-100"),t.classList.add("opacity-0","scale-95"),setTimeout(()=>e.classList.add("hidden"),300)}n?.addEventListener("click",i),s?.addEventListener("click",o),r?.addEventListener("click",o),e?.addEventListener("click",a=>{a.target===e&&o()}),t?.addEventListener("click",a=>a.stopPropagation())}function us(){const e=document.getElementById("send-emails-btn");e&&e.addEventListener("click",async()=>{if(console.log("fsadfasfdas"),!confirm("Are you sure you want to send emails to all results?"))return;const t=e.dataset.url;try{const s=await(await fetch(t,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content,"X-Requested-With":"XMLHttpRequest"}})).json();s.success?(alert(`✅ Emails sent to ${s.count} recipients.`),typeof window.refreshResultsTable=="function"&&setTimeout(()=>{window.refreshResultsTable()},500)):alert(`⚠️ ${s.message}`)}catch(n){console.error(n),alert("❌ Failed to send emails.")}})}function fs(){const e=document.querySelector("#editModal"),t=document.querySelector("#modalContent"),n=document.querySelector("#closeModal"),s=document.querySelector("#cancelBtn"),r=document.querySelector("#editForm"),i=document.querySelector("#editIndex"),o=document.querySelector("#editName"),a=document.querySelector("#editEmail"),f=document.querySelector("#editPhone"),d=document.querySelector("#editMessage"),u=document.querySelector("#saveEditBtn"),m=document.querySelector("#loadingSpinner"),h=document.querySelector("#results-table tbody");if(!e||!t||!r||!h)return;function b(){e.classList.remove("hidden"),requestAnimationFrame(()=>{t.classList.remove("opacity-0","scale-95"),t.classList.add("opacity-100","scale-100")})}function l(){t.classList.remove("opacity-100","scale-100"),t.classList.add("opacity-0","scale-95"),setTimeout(()=>e.classList.add("hidden"),300)}n?.addEventListener("click",l),s?.addEventListener("click",l),e?.addEventListener("click",L=>{L.target===e&&l()}),t?.addEventListener("click",L=>L.stopPropagation());const g=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||"";h.addEventListener("click",L=>{const A=L.target.closest(".edit-btn");if(!A)return;const E=A.closest("tr");if(!E)return;const x=E.querySelectorAll("td");i.value=E.dataset.id??"",o.value=x[1]?.textContent.trim()??"";const O=x[2];if(O){const R=O.querySelector(".truncate");a.value=R?R.textContent.trim():O.textContent.trim()}f.value=x[4]?.textContent.trim()??"";const T=x[6];if(T){const R=T.querySelector(".message-cell");R?d.value=R.getAttribute("data-full-message")||R.getAttribute("title")||R.textContent.trim()||"":d.value=T.textContent.trim()??""}b()}),r.addEventListener("submit",async L=>{if(L.preventDefault(),!u)return;const A=u.dataset.url;if(!A)return;const E={id:i.value,name:o.value,email:a.value,phone:f.value,message:d.value};m?.classList.remove("hidden"),u.disabled=!0;try{const O=await(await fetch(A,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":g},body:JSON.stringify(E)})).json();if(O?.success){const T=h.querySelector(`tr[data-id='${E.id}']`);if(T){const R=T.querySelectorAll("td");if(R[1]&&(R[1].textContent=E.name),R[2]){const I=R[2].querySelector(".truncate")||R[2];I.textContent=E.email,I!==R[2]&&I.setAttribute("title",E.email)}if(R[4]&&(R[4].textContent=E.phone),R[6]){const U=(k=>{const $=document.createElement("div");return $.textContent=k,$.innerHTML})(E.message||"N/A");R[6].innerHTML=`
                            <div class="message-cell max-w-[300px] truncate" 
                                 title="${U}"
                                 data-full-message="${U}">
                                ${U}
                            </div>
                        `}}l(),showAlert("Record updated successfully!","success")}else console.alert("Update failed:",O),showAlert("Update failed! Please try again.","error")}catch(x){console.error(x),showAlert("An error occurred. Please try again.","error")}finally{m?.classList.add("hidden"),u.disabled=!1}})}function ps(){const e=document.getElementById("record-modal"),t=document.getElementById("open-modal"),n=document.getElementById("close-modal");!e||!t||!n||(t.addEventListener("click",()=>{e.classList.remove("hidden"),e.classList.add("flex")}),n.addEventListener("click",()=>{e.classList.add("hidden"),e.classList.remove("flex")}))}function ms(){const e=document.querySelector("#results-table tbody");if(!e)return;const n=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||"",r=document.getElementById("deleted-container")?.dataset.deletedUrl||"/deleted-table";async function i(){try{const h=await fetch("/csv-data",{headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}});if(!h.ok)throw new Error("Failed to fetch CSV data");const b=await h.json();b.success&&b.results&&(e.innerHTML="",b.results.length===0?e.innerHTML=`
                        <tr class="no-records">
                            <td colspan="8" class="px-4 py-8 text-center text-base font-semibold text-slate-500">
                                No CSV Found
                            </td>
                        </tr>
                    `:b.results.forEach((l,y)=>{const g=(l.aqi??0)<=50?"bg-green-100 text-green-700":(l.aqi??0)<=100?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700",L=l.display_id??y+1,A=document.createElement("tr");A.className="hover:bg-indigo-50/40 transition-colors",A.dataset.id=l.id,A.innerHTML=`
                            <td class="px-3 py-2.5 text-sm text-slate-700 font-medium">${L}</td>
                            <td class="px-3 py-2.5 text-sm text-slate-800">${o(l.name)}</td>
                            <td class="px-3 py-2.5 text-sm text-slate-700">
                                <div class="truncate max-w-[180px]" title="${o(l.email)}">${o(l.email)}</div>
                            </td>
                            <td class="px-3 py-2.5 text-sm text-slate-700">${o(l.city)}</td>
                            <td class="px-3 py-2.5 text-sm text-slate-700">${o(l.phone)}</td>
                            <td class="px-3 py-2.5 text-sm font-semibold">
                                <span class="inline-flex items-center rounded-full px-2.5 py-1 text-xs font-medium ${g}">
                                    ${l.aqi??"N/A"}
                                </span>
                            </td>
                            <td class="px-3 py-2.5 text-sm text-slate-700">
                                <div class="message-cell max-w-[300px] truncate" 
                                     title="${o(l.message??"")}"
                                     data-full-message="${o(l.message??"")}">
                                    ${o(l.message??"N/A")}
                                </div>
                            </td>
                            <td class="px-3 py-2.5 text-sm">
                                <div class="inline-flex items-center gap-1.5">
                                    <button 
                                        class="edit-btn inline-flex items-center justify-center rounded-md bg-slate-100 px-2.5 py-1.5 text-xs font-medium text-slate-700 hover:bg-slate-200 transition-colors"
                                        data-index="${y}" 
                                        data-url="/records/update">
                                        Edit
                                    </button>
                                    <button 
                                        class="delete-btn inline-flex items-center justify-center rounded-md bg-red-100 px-2.5 py-1.5 text-xs font-medium text-red-700 hover:bg-red-200 transition-colors" 
                                        data-id="${l.id}" 
                                        data-url="/records/delete">
                                        Delete
                                    </button>
                                </div>
                            </td>
                        `,e.appendChild(A)}))}catch(h){console.error("Error refreshing results table:",h)}}function o(h){if(!h)return"";const b=document.createElement("div");return b.textContent=h,b.innerHTML}window.refreshResultsTable=i;let a=null,f=Date.now();function d(){a||(a=setInterval(async()=>{try{const h=await fetch("/csv-data",{headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}});if(h.ok){const b=await h.json();if(b.success&&b.results){const l=e.querySelectorAll("tr[data-id]");let y=!1;l.length!==b.results.length?y=!0:l.forEach((g,L)=>{const A=g.dataset.id,E=b.results.find(x=>x.id==A);if(E){const x=g.querySelector(".rounded-full")?.textContent.trim(),O=E.aqi??"N/A";x!==String(O)&&(y=!0)}}),y&&(i(),f=Date.now())}}}catch(h){console.error("Error polling for CSV updates:",h)}},1e4))}function u(){a&&(clearInterval(a),a=null)}d(),document.addEventListener("visibilitychange",()=>{document.hidden?u():d()});async function m(h){try{const b=await fetch(h,{headers:{"X-Requested-With":"XMLHttpRequest"}});if(!b.ok)throw new Error("Failed to fetch deleted table");const l=await b.json();document.querySelector("#deleted-table-wrapper").innerHTML=l.html}catch(b){console.error(b)}}e.addEventListener("click",async h=>{const b=h.target.closest(".delete-btn");if(b){h.preventDefault();const l=b.dataset.url,y=b.closest("tr"),g=b.dataset.id??y?.dataset.id;if(!l||!y||!g)return;try{const A=await(await fetch(l,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":n,"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({id:g})})).json();A?.success?(y.remove(),await m(r)):console.warn("Delete failure",A)}catch(L){console.error(L)}}}),document.addEventListener("click",async h=>{const b=h.target.closest("#deleted-table-wrapper a[href]");b&&(h.preventDefault(),await m(b.href))}),document.addEventListener("click",async h=>{const b=h.target.closest("#deleted-table-wrapper a[data-page]");if(b){h.preventDefault();const l=document.getElementById("deleted-length").value||10,y=b.dataset.page,g=`${r}?deleted_page=${y}&perPage=${l}`;await m(g)}}),document.addEventListener("change",async h=>{if(h.target.id==="deleted-length"){const b=h.target.value,l=`${r}?perPage=${b}&deleted_page=1`;await m(l)}})}function hs(){const e=document.getElementById("fetchAll"),t=document.getElementById("aqi-body"),n=document.getElementById("alert-container");if(!e||!t||!n)return;let s=null,r=!1;function i(f,d="success"){const m=`
            <div class="mb-4 rounded-lg border ${d==="success"?"bg-green-50 border-green-200 text-green-800":"bg-red-50 border-red-200 text-red-800"} px-4 py-3 flex items-center justify-between">
                <span>${f}</span>
                <button onclick="this.parentElement.remove()" class="hover:opacity-75">✕</button>
            </div>
        `;n.innerHTML=m,setTimeout(()=>{const h=n.querySelector(".mb-4");h&&h.remove()},5e3)}function o(f){t.innerHTML="",f.forEach(d=>{let u="";if(d.status==="processing")u='<span class="inline-block h-4 w-4 animate-spin rounded-full border-2 border-green-600 border-t-transparent"></span>';else if(d.status==="done"){const h=d.aqi!==null&&d.aqi!==void 0&&d.aqi!==""?parseInt(d.aqi):null;h!==null&&!isNaN(h)&&h>0?u=`<span class="rounded-full px-2 py-1 text-xs font-semibold ${h<=50?"bg-green-100 text-green-700":h<=100?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}">${h}</span>`:u='<span class="text-red-600">Invalid</span>'}else d.status==="pending"?u='<span class="text-slate-500">-</span>':u='<span class="text-red-600">Error</span>';t.insertAdjacentHTML("beforeend",`
                <tr class="hover:bg-indigo-50/40" data-id="${d.id}">
                    <td class="px-4 py-2 text-sm">${d.id}</td>
                    <td class="px-4 py-2 text-sm">${d.name}</td>
                    <td class="px-4 py-2 text-sm">${d.state||"-"}</td>
                    <td class="px-4 py-2 text-sm">${u}</td>
                    <td class="px-4 py-2 text-sm capitalize">${d.status}</td>
                </tr>
            `)})}function a(){fetch("/status").then(f=>{if(!f.ok)throw new Error(`HTTP error! status: ${f.status}`);return f.json()}).then(f=>{Array.isArray(f)&&(o(f),!f.some(u=>u.status==="processing"||u.status==="pending")&&s&&(clearInterval(s),s=null,i("✅ All cities updated successfully!","success")))}).catch(f=>{console.error("Error loading cities:",f)})}e.addEventListener("click",()=>{if(r){i("Update is already in progress. Please wait...","error");return}r=!0,e.disabled=!0,e.textContent="Updating...",s&&(clearInterval(s),s=null),fetch("/fetch-all").then(f=>f.ok?f.json():f.json().then(d=>{throw new Error(d.message||`HTTP error! status: ${f.status}`)})).then(f=>{f.success?(i(f.message||"✅ Started updating AQI values. The table will update automatically as data is fetched.","success"),a(),s||(s=setInterval(a,2e3))):i(f.message||"❌ Failed to start update process. Please try again.","error")}).catch(f=>{console.error("Error fetching AQI data:",f),i(f.message||"Failed to connect to server. Please check your connection and try again.","error")}).finally(()=>{r=!1,e.disabled=!1,e.textContent="Update"})}),a()}function gs(){const e=document.getElementById("tableSearch"),t=document.querySelectorAll("#results-table tbody tr");!e||!t.length||e.addEventListener("keyup",function(){const n=this.value.toLowerCase();t.forEach(s=>{const r=s.innerText.toLowerCase();s.style.display=r.includes(n)?"":"none"})})}function ys(){const e=document.createElement("style");e.innerHTML=`
        .loader {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid #16a34a;
            border-top: 2px solid transparent;
            border-radius: 50%;
            animation: spin 0.7s linear infinite;
        }
        @keyframes spin {
            100% { transform: rotate(360deg); }
        }
    `,document.head.appendChild(e)}function bs(){const e=document.querySelector("#customMessageModal"),t=document.querySelector("#customMessageContent"),n=document.querySelector("#whatsappMessage"),s=document.querySelector("#closeWhatsappMessageModal"),r=document.querySelector("#closeWhatsappMessageBtn");if(!e||!t||!n)return;function i(){e.classList.remove("hidden"),requestAnimationFrame(()=>{t.classList.remove("opacity-0","scale-95"),t.classList.add("opacity-100","scale-100")})}function o(){t.classList.remove("opacity-100","scale-100"),t.classList.add("opacity-0","scale-95"),setTimeout(()=>e.classList.add("hidden"),300)}n.addEventListener("click",i),s?.addEventListener("click",o),r?.addEventListener("click",o),e.addEventListener("click",a=>{a.target===e&&o()}),t.addEventListener("click",a=>a.stopPropagation())}function Es(){const e=document.querySelector("#emailMessageModal"),t=document.querySelector("#emailModalContent"),n=document.querySelector("#open-email-modal"),s=document.querySelector("#closeEmailMessageModal"),r=document.querySelector("#closeEmailMessageBtn");function i(){e.classList.remove("hidden"),requestAnimationFrame(()=>{t.classList.remove("opacity-0","scale-95"),t.classList.add("opacity-100","scale-100")})}function o(){t.classList.remove("opacity-100","scale-100"),t.classList.add("opacity-0","scale-95"),setTimeout(()=>e.classList.add("hidden"),300)}n?.addEventListener("click",i),s?.addEventListener("click",o),r?.addEventListener("click",o),e?.addEventListener("click",a=>{a.target===e&&o()}),t?.addEventListener("click",a=>a.stopPropagation())}function ws(){document.getElementById("save-CSV").addEventListener("click",function(){let e=this.getAttribute("data-url");fetch(e,{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content,Accept:"application/json","Content-Type":"application/json"}}).then(t=>t.json()).then(t=>{t.success,alert(t.message)}).catch(t=>{console.error(t),alert("Something went wrong.")})})}function xs(){document.getElementById("logout-btn").addEventListener("click",function(e){e.preventDefault();const t=this.getAttribute("data-url");console.log("Logout button clicked");const n=document.querySelector('meta[name="csrf-token"]').getAttribute("content");confirm("Do you want to save your changes before logging out?")?(console.log("User chose YES → calling saveCSV..."),fetch(t,{method:"POST",headers:{"X-CSRF-TOKEN":n,"Content-Type":"application/json"},body:JSON.stringify({})}).then(s=>(console.log("Fetch response status:",s.status),s.json())).then(s=>{console.log("SaveCSV response:",s),console.log("Now submitting logout form..."),document.getElementById("logout-form").submit()}).catch(s=>{console.error("Error saving CSV:",s),console.log("Proceeding to logout anyway..."),document.getElementById("logout-form").submit()})):(console.log("User chose NO → logging out immediately"),document.getElementById("logout-form").submit())})}function Ss(){const e=document.getElementById("upload-recipients-form"),t=document.getElementById("addRecipientModal"),n=document.getElementById("addRecipientModalContent"),s=document.getElementById("open-add-recipient-modal"),r=document.getElementById("closeAddRecipientModal"),i=document.getElementById("cancelAddRecipient"),o=document.getElementById("add-recipient-form"),a=document.getElementById("edit-recipient-form"),f=document.getElementById("recipients-file-input"),d=document.getElementById("recipients-file-name"),u=document.getElementById("recipients-table"),m=document.getElementById("recipients-tbody"),h=document.getElementById("recipients-total-count"),b=document.getElementById("recipients-active-count"),l=document.getElementById("recipients-overlay"),y=document.getElementById("editRecipientModal"),g=document.getElementById("closeEditRecipientModal"),L=document.getElementById("cancelEditRecipient");function A(){t&&(t.classList.remove("hidden"),requestAnimationFrame(()=>{n?.classList.remove("opacity-0","scale-95"),n?.classList.add("opacity-100","scale-100")}))}function E(){t&&(n?.classList.remove("opacity-100","scale-100"),n?.classList.add("opacity-0","scale-95"),setTimeout(()=>t.classList.add("hidden"),250))}const x=document.getElementById("recipients-overlay-text");if(s?.addEventListener("click",A),r?.addEventListener("click",E),i?.addEventListener("click",E),t?.addEventListener("click",p=>{p.target===t&&E()}),n?.addEventListener("click",p=>p.stopPropagation()),!e&&!o&&!m)return;const O=u?.dataset.baseUrl||"/whatsapp-recipients",T={"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||"",Accept:"application/json"},R={...T,"Content-Type":"application/json"};let I=parseInt(u?.dataset.startIndex||"1",10);function U(p=""){return String(p).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function k(p,w="success"){const v=document.getElementById("recipients-message");v&&v.remove();const C=document.createElement("div");C.id="recipients-message",C.className=`fixed top-4 right-4 z-[60] rounded-lg px-4 py-3 text-sm font-medium shadow-lg transition-all duration-300 ${w==="success"?"bg-green-500 text-white":"bg-red-500 text-white"}`,C.textContent=p,document.body.appendChild(C),setTimeout(()=>{C.style.opacity="0",C.style.transform="translateX(100%)",setTimeout(()=>C.remove(),300)},4500)}function $(p,w="Loading..."){p&&(p.disabled=!0,p.dataset.originalHtml||(p.dataset.originalHtml=p.innerHTML),p.innerHTML=`<span class="inline-flex items-center gap-2">
            <svg class="h-4 w-4 animate-spin" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
            ${w}
        </span>`)}function _(p){p&&(p.disabled=!1,p.dataset.originalHtml&&(p.innerHTML=p.dataset.originalHtml,delete p.dataset.originalHtml))}function F(p,w="Please wait..."){l&&(x&&w&&(x.textContent=w),l.classList.toggle("hidden",!p))}function G(p){return parseInt(p?.textContent?.replace(/[^0-9]/g,"")||"0",10)}function q(p=0,w=0){h&&p!==0&&(h.textContent=Math.max(0,G(h)+p)),b&&w!==0&&(b.textContent=Math.max(0,G(b)+w))}function Q(p){const w="transition-colors";return p?.active?w:`${w} text-red-700`}function z(p){const w=!!p.active,v=w?"bg-green-100 text-green-700 hover:bg-green-200":"bg-red-100 text-red-700 hover:bg-red-200",C=w?"Active":"Inactive",B=`${O}/${p.id}/toggle-active`;return`<button 
            class="toggle-active-btn inline-flex items-center rounded-full px-3 py-1 text-xs font-medium transition-colors ${v}"
            data-id="${p.id}"
            data-url="${B}">
            ${C}
        </button>`}function me(p){const w=`${O}/${p.id}`;return`<div class="inline-flex items-center gap-2">
            <button 
                class="edit-recipient-btn inline-flex items-center justify-center rounded-md bg-slate-100 px-3 py-1.5 text-xs font-medium text-slate-700 hover:bg-slate-200 transition-colors"
                data-id="${p.id}">
                Edit
            </button>
            <button 
                class="delete-recipient-btn inline-flex items-center justify-center rounded-md bg-red-100 px-3 py-1.5 text-xs font-medium text-red-700 hover:bg-red-200 transition-colors"
                data-id="${p.id}"
                data-url="${w}">
                Delete
            </button>
        </div>`}function he(p,w=""){const v=p.name?U(p.name):"—";return`
            <td class="px-4 py-3 text-sm text-slate-700 font-medium recipient-index-cell">${w}</td>
            <td class="px-4 py-3 text-sm text-slate-800 font-mono">${U(p.phone||"")}</td>
            <td class="px-4 py-3 text-sm text-slate-700">${v}</td>
            <td class="px-4 py-3 text-sm">
                ${z(p)}
            </td>
            <td class="px-4 py-3 text-sm">
                ${me(p)}
            </td>
        `}function V(p,w,v=""){p.dataset.recipientId=w.id,p.dataset.phone=w.phone||"",p.dataset.name=w.name||"",p.dataset.active=w.active?"1":"0",v!==""&&(p.dataset.displayIndex=v)}function Z(p,w){const v=document.createElement("tr");return v.className=Q(p),V(v,p,w),v.innerHTML=he(p,w),v}function Y(p,{prepend:w=!1}={}){if(!m)return;const v=m.children.length,C=w?I:I+v,B=Z(p,C);w&&m.firstChild?m.prepend(B):m.appendChild(B),w&&(I-=1),Oe(),Ue(B)}function K(p){return m?.querySelector(`[data-recipient-id="${p}"]`)}function ge(p){const w=K(p.id);if(!w){Y(p,{prepend:!1});return}const v=w.dataset.displayIndex||"";V(w,p,v),w.className=Q(p),w.innerHTML=he(p,v),Ue(w)}function Bt(p){const w=K(p);if(!w)return{wasActive:!1};const v=w.dataset.active==="1";return w.classList.add("opacity-0","-translate-x-6"),setTimeout(()=>{w.remove(),Oe()},200),{wasActive:v}}function Ue(p){p&&(p.classList.add("ring-2","ring-indigo-200"),setTimeout(()=>{p.classList.remove("ring-2","ring-indigo-200")},1200))}function Oe(){if(!m)return;let p=I;m.querySelectorAll("tr").forEach(w=>{w.dataset.displayIndex=p;const v=w.querySelector(".recipient-index-cell");v&&(v.textContent=p),p+=1})}Oe();async function kt(){if(m)try{const w=await(await fetch(`${O}/list`,{method:"GET",headers:T})).json();w.success&&w.recipients&&(m.innerHTML="",h&&(h.textContent=w.totalCount||0),b&&(b.textContent=w.activeCount||0),I=1,w.recipients.length===0?m.innerHTML=`
                        <tr>
                            <td colspan="5" class="px-4 py-8 text-center text-base font-semibold text-slate-500">
                                No recipients found. Add your first recipient above!
                            </td>
                        </tr>
                    `:w.recipients.forEach((v,C)=>{Y(v,{prepend:!1})}))}catch(p){console.error("Error refreshing table:",p)}}let ye=!1;async function He(){if(!e||!f)return;const p=document.getElementById("recipients-file-error");if(!f.files?.length||ye){ye||k("Please select a file to upload","error");return}p&&(p.textContent="");const w=new FormData(e);try{ye=!0,F(!0,"Uploading recipients..."),f.disabled=!0;const C=await(await fetch(`${O}/upload-csv`,{method:"POST",headers:T,body:w})).json();if(C.success)k(C.message||"Recipients uploaded successfully!","success"),f.value="",d&&(d.textContent=""),await kt();else{const B=C.error||C.message||"Failed to upload file";k(B,"error"),p&&(p.textContent=B)}}catch(v){const C=`Error uploading file: ${v.message}`;k(C,"error"),p&&(p.textContent=C)}finally{ye=!1,F(!1),f.disabled=!1}}e&&e.addEventListener("submit",p=>{p.preventDefault(),He()}),o&&o.addEventListener("submit",async p=>{p.preventDefault();const w=o.querySelector('button[type="submit"]'),v=new FormData(o),C=document.getElementById("active"),B={phone:v.get("phone"),name:v.get("name"),active:C?C.checked:!0};if(!B.phone||B.phone.trim()===""){k("Phone number is required","error");return}$(w,"Adding...");try{const N=await(await fetch(O,{method:"POST",headers:R,body:JSON.stringify(B)})).json();N.success?(k(N.message||"Recipient added successfully!","success"),o.reset(),E(),N.recipient&&(Y(N.recipient,{prepend:!1}),q(1,N.recipient.active?1:0))):k(N.message||"Failed to add recipient","error")}catch(J){k(`Error adding recipient: ${J.message}`,"error")}finally{_(w)}}),a&&a.addEventListener("submit",async p=>{p.preventDefault();const w=a.querySelector('button[type="submit"]'),v=document.getElementById("edit-recipient-id")?.value,C=new FormData(a),B=document.getElementById("edit-active"),J={phone:C.get("phone"),name:C.get("name"),active:B?B.checked:!1};if(!J.phone||J.phone.trim()===""){k("Phone number is required","error");return}$(w,"Updating...");try{const H=await(await fetch(`${O}/${v}`,{method:"PUT",headers:R,body:JSON.stringify(J)})).json();if(H.success&&H.recipient){const se=K(H.recipient.id)?.dataset.active==="1";ge(H.recipient);const re=(H.recipient.active?1:0)-(se?1:0);q(0,re),k(H.message||"Recipient updated successfully!","success"),be()}else k(H.message||"Failed to update recipient","error")}catch(N){k(`Error updating recipient: ${N.message}`,"error")}finally{_(w)}}),f&&d&&f.addEventListener("change",p=>{const w=p.target.files[0];w?(d.textContent=`Selected: ${w.name} (${(w.size/1024).toFixed(2)} KB)`,d.className="mt-2 text-sm text-green-600",He()):d.textContent=""}),m&&m.addEventListener("click",async p=>{const w=p.target.closest(".edit-recipient-btn"),v=p.target.closest(".delete-recipient-btn"),C=p.target.closest(".toggle-active-btn");if(w){const B=w.closest("tr");if(!B)return;document.getElementById("edit-recipient-id").value=B.dataset.recipientId,document.getElementById("edit-phone").value=B.dataset.phone||"",document.getElementById("edit-name").value=B.dataset.name||"",document.getElementById("edit-active").checked=B.dataset.active==="1",Mt();return}if(v){if(!confirm("Are you sure you want to delete this recipient?"))return;$(v,"Deleting...");const B=v.dataset.id,J=v.dataset.url||`${O}/${B}`;try{const H=await(await fetch(J,{method:"DELETE",headers:R})).json();if(H.success){const{wasActive:se}=Bt(B);q(-1,se?-1:0),k(H.message||"Recipient deleted successfully!","success")}else k(H.message||"Failed to delete recipient","error")}catch(N){k(`Error deleting recipient: ${N.message}`,"error")}finally{_(v)}return}if(C){$(C,"");const B=C.dataset.id,J=C.dataset.url||`${O}/${B}/toggle-active`,N=K(B),H=N?.dataset.active==="1";try{const re=await(await fetch(J,{method:"POST",headers:R})).json();if(re.success){const oe=!!re.active;N&&(N.dataset.active=oe?"1":"0",N.className=Q({active:oe})),q(0,oe===H?0:oe?1:-1),C.className=`toggle-active-btn inline-flex items-center rounded-full px-3 py-1 text-xs font-medium transition-colors ${oe?"bg-green-100 text-green-700 hover:bg-green-200":"bg-red-100 text-red-700 hover:bg-red-200"}`,C.textContent=oe?"Active":"Inactive",C.dataset.originalHtml=C.innerHTML,k(re.message||"Status updated successfully!","success")}else k(re.message||"Failed to update status","error")}catch(se){k(`Error updating status: ${se.message}`,"error")}finally{_(C)}}});function Mt(){y&&(y.classList.remove("hidden"),requestAnimationFrame(()=>{const p=y.querySelector(".bg-white");p&&(p.classList.remove("opacity-0","scale-95"),p.classList.add("opacity-100","scale-100"))}))}function be(){if(!y)return;const p=y.querySelector(".bg-white");p&&(p.classList.remove("opacity-100","scale-100"),p.classList.add("opacity-0","scale-95")),setTimeout(()=>y.classList.add("hidden"),250)}g?.addEventListener("click",be),L?.addEventListener("click",be),y?.addEventListener("click",p=>{p.target===y&&be()}),y?.querySelector(".bg-white")?.addEventListener("click",p=>p.stopPropagation())}function vs(){const e=document.getElementById("messages-tbody"),t=document.getElementById("messages-total-count"),n=document.getElementById("messages-unread-count"),s=document.querySelector('[data-tab="incoming-messages"]');if(!e)return;let r=null,i=null,o=!1;const a=e.querySelector("tr[data-message-id]");a&&(i=parseInt(a.getAttribute("data-message-id")));async function f(){try{const x=await(await fetch("/incoming-messages/list")).json();x.success&&x.messages&&(d(x.messages),u(x.totalCount,x.unreadCount),m(x.unreadCount))}catch(E){console.error("Error refreshing messages:",E)}}window.refreshIncomingMessages=f;function d(E){if(!E||E.length===0){if(e.querySelector("tr"))return;e.innerHTML=`
                <tr>
                    <td colspan="6" class="px-6 py-12 text-center text-slate-500">
                        No messages received yet. Messages from users will appear here.
                    </td>
                </tr>
            `;return}const x=E.length>0&&(!i||E[0].id>i);E.length>0&&(i=E[0].id);const O=E.map(T=>{const R=T.read?"":"bg-indigo-50/50",I=T.read?'<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-800">Read</span>':'<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">Unread</span>',U={text:"💬 Text",image:"🖼️ Image",video:"🎥 Video",audio:"🎵 Audio",document:"📄 Document",location:"📍 Location"},k={text:"bg-blue-100 text-blue-800",image:"bg-green-100 text-green-800",video:"bg-purple-100 text-purple-800",audio:"bg-yellow-100 text-yellow-800",document:"bg-orange-100 text-orange-800",location:"bg-pink-100 text-pink-800"},$=U[T.type]||T.type,_=k[T.type]||"bg-slate-100 text-slate-800";let F="";T.type==="text"?F=b(T.message||"").substring(0,100):T.type==="location"?F=`📍 Location (${parseFloat(T.latitude).toFixed(6)}, ${parseFloat(T.longitude).toFixed(6)})`:T.message?F=b(T.message).substring(0,50)+" (Caption)":F='<span class="text-slate-400">No caption</span>';const G=new Date(T.created_at),q=G.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),Q=G.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),z=T.read?"":`<button onclick="markAsRead(${T.id})" class="text-indigo-600 hover:text-indigo-900 mr-3">Mark as Read</button>`;return`
                <tr class="hover:bg-slate-50 ${R}" data-message-id="${T.id}">
                    <td class="px-6 py-4 whitespace-nowrap">${I}</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm font-medium text-slate-900">${b(T.from)}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${_}">
                            ${$}
                        </span>
                    </td>
                    <td class="px-6 py-4">
                        <div class="text-sm text-slate-900">${F}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-slate-500">
                        ${q}<br>${Q}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                        ${z}
                        <button onclick="deleteMessage(${T.id})" class="text-red-600 hover:text-red-900">Delete</button>
                    </td>
                </tr>
            `}).join("");e.innerHTML=O,x&&o&&h(E.length>0?1:0)}function u(E,x){t&&(t.textContent=E||0),n&&(n.textContent=x||0)}function m(E){if(!s)return;let x=s.querySelector(".bg-red-600");E>0?(x||(x=document.createElement("span"),x.className="absolute -top-1 -right-1 inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-white transform translate-x-1/2 -translate-y-1/2 bg-red-600 rounded-full",s.appendChild(x)),x.textContent=E):x&&x.remove()}function h(E){const x=document.createElement("div");x.className="fixed top-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50",x.textContent=`📩 ${E} new message${E>1?"s":""} received!`,document.body.appendChild(x),setTimeout(()=>{x.style.opacity="0",x.style.transition="opacity 0.3s",setTimeout(()=>x.remove(),300)},3e3)}function b(E){if(!E)return"";const x=document.createElement("div");return x.textContent=E,x.innerHTML}function l(){r||(f(),r=setInterval(()=>{f()},3e3))}function y(){r&&(clearInterval(r),r=null)}function g(){const E=document.getElementById("incoming-messages");o=E&&!E.classList.contains("hidden"),o?l():y()}document.querySelectorAll(".tab-btn").forEach(E=>{E.addEventListener("click",()=>{setTimeout(g,100)})}),g(),setInterval(g,1e3);const A=document.getElementById("refresh-messages-btn");A&&A.addEventListener("click",()=>{f()})}window.markAsRead=function(e){fetch(`/incoming-messages/${e}/mark-as-read`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.content||""}}).then(t=>t.json()).then(t=>{if(t.success){const n=window.refreshIncomingMessages;n&&n()}else alert("Error: "+t.message)}).catch(t=>{console.error("Error:",t),alert("Failed to mark message as read")})};window.deleteMessage=function(e){confirm("Are you sure you want to delete this message?")&&fetch(`/incoming-messages/${e}`,{method:"DELETE",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.content||""}}).then(t=>t.json()).then(t=>{if(t.success){const n=window.refreshIncomingMessages;n&&n()}else alert("Error: "+t.message)}).catch(t=>{console.error("Error:",t),alert("Failed to delete message")})};document.addEventListener("DOMContentLoaded",()=>{as(),cs(),ls(),ds(),us(),fs(),ps(),ms(),hs(),gs(),ys(),bs(),Es(),ws(),xs(),Ss(),vs()});
